請幫我撰寫一個名為 type.py 的 Python 程式，實現以下功能：

功能描述
輸入功能：

使用 getch 方法逐字符讀取輸入（無需按 Enter）。
支援拼音輸入，按字母逐步匹配候選詞組，並動態顯示選項。
支援多位數字輸入來選擇候選項目。
輸出緩衝區：

按下空格鍵後，將選中的詞組加入輸出緩衝區。
設定每行最大字元數，例如 20，超過時自動換行。
匹配功能：

按輸入的拼音在 key2ph 表中查找候選詞組。
未匹配時，不退出程式，等待下一次輸入。
文件解析：

讀取 pinyin.cin 文件，提取每個漢字的拼音首字母。
讀取 word*.txt 文件，建立拼音與詞組的對應表 key2ph。
特殊功能：

按 ~ 查看完整的 key2ph 表。
按 Ctrl-C 或 Ctrl-D 退出程式。
輸入文件格式
1. pinyin.cin 文件
格式：
arduino
複製程式碼
%chardef begin
a    啊
b    吧
c    詞
h    彙
%chardef end
2. word*.txt 文件
格式：
複製程式碼
詞彙 ch
詞吧 cb
使用流程
啟動程式後，輸入拼音。
輸入數字選擇候選詞，按空格確認。
按 ~ 查看候選表，或按 Ctrl-C / Ctrl-D 退出。
請基於以上描述撰寫完整的 type.py 程式。
